const themeToggle=document.querySelector(".theme-toggle");function setTheme(e){document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),themeToggle.setAttribute("aria-label","dark"===e?"Switch to light mode":"Switch to dark mode"),document.querySelector('meta[name="theme-color"]').setAttribute("content","dark"===e?"#0D0D0D":"#FFFFFF")}themeToggle.addEventListener("click",()=>{let e=document.documentElement.getAttribute("data-theme"),t="dark"===e?"light":"dark";setTheme(t),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"theme_toggle",theme:t})}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")||setTheme(e.matches?"dark":"light")});const initTheme=document.documentElement.getAttribute("data-theme");themeToggle.setAttribute("aria-label","dark"===initTheme?"Switch to light mode":"Switch to dark mode");const prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(prefersReducedMotion)document.querySelectorAll(".reveal").forEach(e=>e.classList.add("visible"));else{let e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("visible"),e.unobserve(t.target))})},{threshold:.08,rootMargin:"0px 0px -30px 0px"});document.querySelectorAll(".reveal").forEach(t=>e.observe(t))}const nav=document.querySelector(".nav");window.addEventListener("scroll",()=>{nav.classList.toggle("scrolled",window.scrollY>20)},{passive:!0});const navToggle=document.querySelector(".nav-toggle"),navMenu=document.querySelector(".nav-links"),navOverlay=document.querySelector(".nav-overlay");function openNav(){navToggle.setAttribute("aria-expanded","true"),navToggle.setAttribute("aria-label","Close navigation menu"),navMenu.classList.add("open"),navOverlay.classList.add("active"),document.body.style.overflow="hidden"}function closeNav(){navToggle.setAttribute("aria-expanded","false"),navToggle.setAttribute("aria-label","Open navigation menu"),navMenu.classList.remove("open"),navOverlay.classList.remove("active"),document.body.style.overflow=""}function initContactForm(){let e=document.getElementById("contact-form"),t=document.getElementById("submit-btn"),a=document.getElementById("form-status");function n(e,t){let a=document.getElementById(t),n="";return e.value.trim()?"email"!==e.type||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value)||(n="Please enter a valid email address."):n=e.name.charAt(0).toUpperCase()+e.name.slice(1)+" is required.",a.textContent=n,e.classList.toggle("invalid",!!n),e.setAttribute("aria-invalid",!!n),!n}e&&(["contact-name","contact-email","contact-message"].forEach(e=>{let t=document.getElementById(e),a=e.replace("contact-","")+"-error";t.addEventListener("blur",()=>n(t,a)),t.addEventListener("input",()=>{t.classList.contains("invalid")&&n(t,a)})}),e.addEventListener("submit",async r=>{if(r.preventDefault(),document.getElementById("c-website").value)return;let i=n(document.getElementById("contact-name"),"name-error"),l=n(document.getElementById("contact-email"),"email-error"),o=n(document.getElementById("contact-message"),"message-error");if(!i||!l||!o){let s=e.querySelector(".invalid");s&&s.focus();return}t.disabled=!0,t.textContent="Sending...",a.textContent="",a.className="form-status";try{let d=new FormData(e),c=await fetch(e.action,{method:"POST",body:d,headers:{Accept:"application/json"}});if(c.ok)a.textContent="Message sent. Thank you!",a.className="form-status success",window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"form_submit",form_name:"contact"}),e.reset(),e.querySelectorAll(".invalid").forEach(e=>e.classList.remove("invalid")),e.querySelectorAll(".form-error").forEach(e=>e.textContent="");else throw Error("Server error")}catch(u){a.textContent="Something went wrong. Please try again or email me directly.",a.className="form-status error"}finally{t.disabled=!1,t.textContent="Send message"}}))}function initTracking(){document.querySelectorAll('a[href^="http"]').forEach(e=>{e.href.includes("taniainteractive.co.uk")||e.addEventListener("click",()=>{window.dataLayer.push({event:"outbound_click",link_url:e.href,link_text:e.textContent.trim().substring(0,100)})})});let e=document.getElementById("email-link");e&&e.addEventListener("click",()=>{window.dataLayer.push({event:"email_click"})});let t=document.querySelectorAll("section[id]"),a=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(window.dataLayer.push({event:"section_view",section_id:e.target.id}),a.unobserve(e.target))})},{threshold:.3});t.forEach(e=>a.observe(e)),document.querySelectorAll(".btn, .nav-cta").forEach(e=>{e.addEventListener("click",()=>{window.dataLayer.push({event:"cta_click",cta_text:e.textContent.trim(),cta_url:e.href||e.closest("a")?.href||""})})})}navToggle.addEventListener("click",()=>{let e="true"===navToggle.getAttribute("aria-expanded");e?closeNav():openNav()}),navOverlay.addEventListener("click",closeNav),navMenu.querySelectorAll("a").forEach(e=>e.addEventListener("click",closeNav)),document.addEventListener("keydown",e=>{"Escape"===e.key&&"true"===navToggle.getAttribute("aria-expanded")&&(closeNav(),navToggle.focus())}),function(){let e=document.getElementById("email-link");if(e){let t=e.getAttribute("data-name"),a=e.getAttribute("data-domain"),n=t+"@"+a;e.href="mailto:"+n,e.textContent=n,e.removeAttribute("data-name"),e.removeAttribute("data-domain")}}(),"requestIdleCallback"in window?requestIdleCallback(initContactForm):setTimeout(initContactForm,1e3),window.dataLayer=window.dataLayer||[],"requestIdleCallback"in window?requestIdleCallback(initTracking):setTimeout(initTracking,2e3),function(){let e=document.getElementById("landingpad-video"),t=document.getElementById("landingpad-play");if(!e||!t)return;let a=window.innerWidth<=680,n=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(a||n)return;let r=!1;function i(){if(r)return;let t=e.querySelector("source[data-src]");t&&(t.src=t.getAttribute("data-src"),t.removeAttribute("data-src"),e.load(),r=!0)}let l=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(i(),l.unobserve(e))})},{rootMargin:"200px"});function o(){i(),e.play().catch(()=>{}),t.classList.add("hidden"),t.setAttribute("aria-label","Pause video"),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"video_play",video_name:"landingpad-builder-demo"})}l.observe(e),t.addEventListener("click",o),e.addEventListener("click",()=>{e.paused?o():(e.pause(),t.classList.remove("hidden"),t.setAttribute("aria-label","Play video"),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"video_pause",video_name:"landingpad-builder-demo"}))}),e.addEventListener("ended",()=>{t.classList.remove("hidden"),t.setAttribute("aria-label","Play video"),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"video_complete",video_name:"landingpad-builder-demo"})})}();